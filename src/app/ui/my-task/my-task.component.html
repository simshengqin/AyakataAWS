<app-header></app-header>
<div class="max-width-section">
  <div class="row" >
    <div class="col">
      <select class="form-control mb-3" >
        <option *ngFor="let option of options.Month" [value]="option.key == 'Month' ? '' : option.key" [selected]="option.selected">{{option.key}}</option>
      </select>
    </div>
    <div class="col">
      <select class="form-control mb-3" >
        <option *ngFor="let option of options.Year" [value]="option.key == 'Year' ? '' : option.key" [selected]="option.selected">{{option.key}}</option>
      </select>
    </div>
  </div>

  <div class="table-responsive table-hover">
    <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8">

      <!-- Position Column -->
      <ng-container matColumnDef="position">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> No. </th>
        <td mat-cell *matCellDef="let element; let i = index"> {{ element["position"] }} </td>
      </ng-container>

      <ng-container matColumnDef="filename">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Filename </th>
        <td mat-cell *matCellDef="let element"> {{ element["filename"] }} </td>
      </ng-container>

      <ng-container matColumnDef="uploadDate">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Upload Date </th>
        <td mat-cell *matCellDef="let element"> {{ element["uploadDate"] | date: fullMonthDayYearFormat}} </td>
      </ng-container>

      <ng-container matColumnDef="patientCount">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Patient Count </th>
        <td mat-cell *matCellDef="let element"> {{ element["patientCount"] }} </td>
      </ng-container>

      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef mat-sort-header> Status </th>
        <td mat-cell *matCellDef="let element">
          <span *ngIf="element.status2 == 0"> Processing </span>
          <span *ngIf="element.status2 == 1 || element.status2 == 2"> Completed </span>
          <span *ngIf="element.status2 == 1 || element.status2 == 2" class="view-report" (click)="onViewReport(element.filename)">
            View Report >
          </span>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="tableColumns"></tr>
      <tr
        mat-row
        (click)="clickedRows.has(row) ? clickedRows.delete(row) : clickedRows.add(row)"
        [class.demo-row-is-clicked]="clickedRows.has(row)"
        *matRowDef="let row; columns: tableColumns;"
      ></tr>
    </table>
  </div>
  <div *ngIf="!dataSource" class="spinner-container">
    <mat-progress-spinner class="mt-2 mb-2" mode="indeterminate" [diameter]="40"></mat-progress-spinner>
  </div>
  <mat-paginator class="mt-3" [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
  <app-chart></app-chart>
</div>
